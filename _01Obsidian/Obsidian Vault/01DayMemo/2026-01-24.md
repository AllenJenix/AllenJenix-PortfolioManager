# 🛠️ Portfolio Manager Project Log

## 📅 Last Updated: 2026-01-24
## 📂 System Architecture (Data Pipeline)
1. **00Transaction_History.csv**: 거래 내역 (XIRR/Flow 계산용)
2. **01Asset_Summary.csv**: 월간 자산 요약 (Anchor 보정용)
3. **02Portfolio_Holdings.csv**: 현재 잔고 현황
4. **03Full_Portfolio.csv**: 현금/RP 비중 통합 완료
5. **04Daily_Asset_Ledger.csv**: 하이브리드 보간법(Interpolation) 기반 일별 원장
6. **05Performance_Data.csv**: TWR/MWR/MDD 연산 결과물

## 🛠️ Development Log (금일 개발 요약)
- [x] **Feature**: 하이브리드 일별 자산 원장 생성 엔진 개발
- [x] **Feature**: TWR(시간가중), MWR(금액가중), MDD(최대낙폭) 연산 알고리즘 구현
- [x] **Refactoring**: 계산 엔진(`calc_metrics.py`)과 시각화 엔진(`viz_metrics.py`)의 모듈 분리(Decoupling)
- [x] **Logic**: 입출금 시점(Flow Timing)에 따른 수익률 왜곡 방지 로직 적용

## 🚀 Technical Achievement (개발 성과 KPI)
| 항목 | 상태/수치 | 비고 |
| :--- | :--- | :--- |
| **데이터 정밀도** | **최상 (1원 단위)** | Asset Summary 앵커를 통한 오차 자동 보정 |
| **로직 완성도** | **TWR, XIRR, MDD** | 복합 수익률 연산 엔진 검증 완료 |
| **자동화 수준** | **부분 자동화** | 파일 업로드 후 코드 실행 시 전 과정 자동 처리 |
| **시스템 커버리지** | **389일 (전 기간)** | 2025.01.01 ~ 현재까지의 타임라인 확보 |

## 💡 Engineering Insights (기술적 통찰)
- **하이브리드 보간법**: 단순 직선 보간은 입출금 발생 시 자산 변동을 왜곡함. 입출금을 우선 반영한 뒤 잔여 오차를 선형 배분하는 방식으로 데이터 신뢰도를 확보함.
- **모듈화의 중요성**: 연산 로직과 시각화 로직을 분리함으로써, 향후 벤치마크(S&P 500 등) 비교 기능을 추가할 때 기존 코드의 영향 없이 확장 가능하게 설계함.

## 📝 Financial Commentary & Notes (기타 사견)
- **시스템 출력값**: 금일 기준 TWR 23.70%, MWR 36.63% 산출됨. 
- **수익률 분석 사견**: MWR이 높은 것을 보아 시스템상 자금 흐름(Flow) 반영이 정확히 작동하고 있음을 확인. (입금 타이밍의 효과가 수치로 입증됨)
- **기타**: 향후 '주주서한' 기능 추가 시, 이 일별 원장 데이터를 어떻게 텍스트로 요약할지 고민 필요.

## ⏭️ Next Sprint (향후 개발 과제)
- [ ] **과거 비중 복원**: Transaction 기반 일별 종목 수량 추적 로직 개발
- [ ] **FIFO 엔진**: 선입선출법 기반 실현 손익 및 평단가 재계산 모듈